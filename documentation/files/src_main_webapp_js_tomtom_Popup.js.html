<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src&#x2F;main&#x2F;webapp&#x2F;js&#x2F;tomtom&#x2F;Popup.js - TomTom JavaScript SDK</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http:&#x2F;&#x2F;www.tomtom.com&#x2F;global&#x2F;images&#x2F;tomtom-logo_tcm166-3340.png" title="TomTom JavaScript SDK"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.6-RELEASE</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/tomtom.Animation.html">tomtom.Animation</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.Cluster.html">tomtom.Cluster</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.ClusterMarker.html">tomtom.ClusterMarker</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.ClusterPopup.html">tomtom.ClusterPopup</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.controls.AutoComplete.html">tomtom.controls.AutoComplete</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.controls.ContextMenu.html">tomtom.controls.ContextMenu</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.controls.OverviewMap.html">tomtom.controls.OverviewMap</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.controls.PanZoomBar.html">tomtom.controls.PanZoomBar</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.controls.RouteControl.html">tomtom.controls.RouteControl</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.CustomIcon.html">tomtom.CustomIcon</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.CustomMarker.html">tomtom.CustomMarker</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.dom.DomUtil.html">tomtom.dom.DomUtil</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.dom.DomUtilResult.html">tomtom.dom.DomUtilResult</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.layers.MapLayer.html">tomtom.layers.MapLayer</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.layers.MarkerLayer.html">tomtom.layers.MarkerLayer</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.layers.TrafficIncidentLayer.html">tomtom.layers.TrafficIncidentLayer</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.layers.TrafficLayer.html">tomtom.layers.TrafficLayer</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.Main.html">tomtom.Main</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.Map.html">tomtom.Map</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.Marker.html">tomtom.Marker</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.MarkerManager.html">tomtom.MarkerManager</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.Popup.html">tomtom.Popup</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.services.GeocodingService.html">tomtom.services.GeocodingService</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.services.InitializeService.html">tomtom.services.InitializeService</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.services.LegacyGeocodingService.html">tomtom.services.LegacyGeocodingService</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.services.RoutingService.html">tomtom.services.RoutingService</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.services.TrafficService.html">tomtom.services.TrafficService</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.services.ViewportService.html">tomtom.services.ViewportService</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.TrafficClusterPopup.html">tomtom.TrafficClusterPopup</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.TrafficIncidentPopup.html">tomtom.TrafficIncidentPopup</a></li>
            
                <li><a href="..&#x2F;classes/tomtom.TrafficMarker.html">tomtom.TrafficMarker</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src&#x2F;main&#x2F;webapp&#x2F;js&#x2F;tomtom&#x2F;Popup.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
define([
		&quot;.&#x2F;DomUtil&quot;,
		&quot;.&#x2F;Utils&quot;,
		&quot;.&#x2F;OpenLayers&quot;
	],
	
	function(du, utils) {
		var base = OpenLayers.Popup.Anchored;
		
		tomtom.Popup = OpenLayers.Class(base, {
			
			&#x2F;**
			 * Displays a popup for a given marker on the map.
			 * This constructor should not be called directly.  It is recommended that the {{#crossLink &quot;Marker&#x2F;setPopup&quot;}}setPopup{{&#x2F;crossLink}} method on the
			 * {{#crossLink &quot;Marker&quot;}}Marker{{&#x2F;crossLink}} be used.
			 * 
			 * Adding a popup to a marker:
			 * 
			 * 	var marker = new tomtom.Marker(-71.53686, 43.20846);
			 * 	marker.setPopup(tomtom.Popup, { contentHTML: &quot;My popup&quot; }, &quot;click&quot;);
			 * 
			 * Creating a custom popup from an existing DOM Node:
			 * 
			 * 	var marker = new tomtom.Marker(-71.53686, 43.20846);
			 * 	var div = document.createElement(&quot;div&quot;);
			 * 	div.innerHTML = &quot;my custom content&quot;;
			 * 
			 * 	marker.setPopup(tomtom.Popup, { contentHTML: null }, &quot;click&quot;);
			 * 	marker.popup.contentDiv.appendChild(div);
			 * 
			 * @constructor
			 * @extends OpenLayers.Popup.Anchored
			 * @class Popup
			 * @param {Object} options The options used to create the popup.
			 * @param {tomtom.Marker} [options.marker] The marker the popup will be attached to.  If this is not specified, the lonlat option must be specified.
			 * @param {OpenLayers.LonLat} [options.lonlat] The longitude &#x2F; latitude where the marker should be added.  If this is not specified, the marker option must be specified.
			 * @param {OpenLayers.Size} [options.contentSize=200x200] The size of the popup.
			 * @param {String} [options.contentHTML] The markup to append to the inner content div of the popup.  
			 * This option can be specified as null to add nothing to the innerHTML of the content div. 
			 * This is useful if a DOM Node is to be added to the content div (see the above example).
			 *&#x2F;
			initialize: function(options) {
				
				this.autoSize = true;
				this.closeOnMove = true;
				this.marker = options.marker;
				
				var lonlat = null, anchor = null;
				
				if (typeof(options.animation) == &quot;undefined&quot;)
					this.animation = { effect: &quot;fade&quot;, duration: 250 };
				else
					this.animation = options.animation;
				
				&#x2F;&#x2F; determine if the popup is being added to a marker
				if (options.marker) {
					lonlat = options.marker.lonlat;
					anchor = options.marker.icon;
				} else {
					lonlat = options.lonlat;
				}
				
				base.prototype.initialize.apply(this, [
					options.id, 
					lonlat, 
					options.contentSize, 
					options.contentHTML, 
					anchor, 
					false
				]);
				
				this.groupDiv.className = &quot;olPopupInner&quot;;
				
				&#x2F;&#x2F; add a wrapper div
				var wrapper = this.addDiv(&quot;olPopupWrapper&quot;, this.groupDiv);
				
				&#x2F;&#x2F; add the side div
				var side = this.addDiv(&quot;olPopupSide&quot;, wrapper);
				
				&#x2F;&#x2F; move the content div into the wrapper
				wrapper.appendChild(this.contentDiv);
				
				&#x2F;&#x2F; add the bottom div
				var bottom = this.addDiv(&quot;olPopupBottom&quot;, this.div);
				var bottomInner = this.addDiv(&quot;&quot;, bottom);
				
				&#x2F;&#x2F; add the arrow div
				var arrow = this.addDiv(&quot;olPopupArrow&quot;, this.div);
				
				&#x2F;&#x2F; reset styles that OpenLayers sets
				du.css(this.div, &quot;overflow&quot;, &quot;visible&quot;);
				du.css(this.groupDiv, &quot;overflow&quot;, &quot;visible&quot;);
				
				&#x2F;&#x2F; remove the width &#x2F; height on the content div
				if (!options.contentSize) {
					du.css(this.div, &quot;width&quot;, &quot;&quot;);
					du.css(this.div, &quot;height&quot;, &quot;&quot;);
					du.css(this.contentDiv, &quot;width&quot;, &quot;&quot;);
					du.css(this.contentDiv, &quot;height&quot;, &quot;&quot;);
				}
				
			},
			
			addDiv: function(className, parent) {
				var div = document.createElement(&quot;div&quot;);
				div.className = className;
				parent.appendChild(div);
				
				return div;
			},
			
			setBackgroundColor: function() {
				&#x2F;&#x2F; do nothing, this should be set via css
			},
			
			setBorder: function() {
				&#x2F;&#x2F; do nothing, this should be set via css
			},
			
			updateSize: function() {
				&#x2F;&#x2F; do nothing
			},
			
			setSize: function() {
				
				&#x2F;&#x2F;base.prototype.setSize.apply(this, arguments);
				
			},
			
			setOpacity: function(opacity) {				
				&#x2F;&#x2F; IE fix
				if (opacity &gt;= 1 || opacity == null) {
					this.div.style.filter = &quot;&quot;;
					return;
				}
				
				base.prototype.setOpacity.apply(this, arguments);
			},
			
			moveTo: function() {
				var bottom = du.query(&quot;.olPopupBottom&quot;, this.div);
				
				if (this.div.offsetWidth &gt; 0) {
					&#x2F;&#x2F; hack for IE7 stupidity
					bottom.css(&quot;width&quot;, this.div.offsetWidth + &quot;px&quot;);
				}
				
				this.size = new OpenLayers.Size(this.div.offsetWidth, this.div.offsetHeight);
				
				base.prototype.moveTo.apply(this, arguments);
				
				if (this.marker) {
					var left = parseInt(du.css(this.div, &quot;left&quot;));
					var top = parseInt(du.css(this.div, &quot;top&quot;));
					var iconWidth = this.marker.icon.imageDiv.offsetWidth;
					var iconHeight = this.marker.icon.imageDiv.offsetHeight;
					
					&#x2F;&#x2F; if the marker icon has an offset, use it to specify where the popup is anchored
					if (this.marker.icon.offset) {
						&#x2F;&#x2F; offset the popup based on the size of the marker icon
						if (this.relativePosition == &quot;tr&quot; || this.relativePosition == &quot;br&quot;) {
							du.css(this.div, &quot;left&quot;, (left - (iconWidth - Math.abs(this.marker.icon.offset.x))) + &quot;px&quot;);
						} else {
							du.css(this.div, &quot;left&quot;, (left + Math.abs(this.marker.icon.offset.x)) + &quot;px&quot;);
						}
						
						if (this.relativePosition == &quot;br&quot; || this.relativePosition == &quot;bl&quot;) {
							du.css(this.div, &quot;top&quot;, top - (iconHeight - Math.abs(this.marker.icon.offset.y)));
						}
					}
				}
			},
			
			updateRelativePosition: function() {
				
				du.attr(this.div, &quot;class&quot;, &quot;olPopup&quot;);
				&#x2F;&#x2F; add the class to the outer div
				du.addClass(this.div, &quot;olPopup-&quot; + this.relativePosition);
				
			},
			
			&#x2F;**
			 * Shows the popup.  If an animation is enabled, the show will be animated. please note that the popup will have to have already been added to the map like so:
			 * 
			 * 	map.addPopup(popup);
			 * 
			 * Otherwise, this method will do nothing.
			 * @method show
			 * @param {Function} callback The function to be executed when the popup has completed its show animation.
			 *  This is only necessary if animations are enabled.
			 * 
			 *&#x2F;
			show: function(callback) {
				
				base.prototype.show.apply(this, arguments);
				
				if (this.marker)
					this.lonlat = this.marker.lonlat;
				
				this.updatePosition();
				
				&#x2F;&#x2F; use animations
				if (this.animation &amp;&amp; this.animation.effect) {
					new tomtom.Animation(this.div, this.animation.effect + &quot;In&quot;, {
						duration: this.animation.duration, 
						callback: callback 
					}).play();
				}
				
			},
			
			&#x2F;**
			 * Hides the popup using an animation if animations are enabled.
			 * @method hide
			 * @param {Function} callback The function to be executed when the popup has completed its hide animation.
			 *  This is only necessary if animations are enabled.
			 *&#x2F;
			hide: function(callback) {

				&#x2F;&#x2F; make sure the div hasn&#x27;t already been destroyed
				if (this.div) {
					&#x2F;&#x2F; use animations
					if (this.animation &amp;&amp; this.animation.effect) {
						new tomtom.Animation(this.div, this.animation.effect + &quot;Out&quot;, {
							callback: utils.hitch(this, function() {
								&#x2F;&#x2F; make sure the popup hasn&#x27;t been destroyed
								if (this.div) {
									base.prototype.hide.apply(this, []);

									&#x2F;&#x2F; fire the hide event
									this.events.triggerEvent(&quot;hide&quot;);
								}
								
								if (typeof(callback) == &quot;function&quot;)
									callback();
							}),
							
							duration: this.animation.duration
						}).play();
					} else {
						base.prototype.hide.apply(this, arguments);
						
						&#x2F;&#x2F; fire the hide event
						this.events.triggerEvent(&quot;hide&quot;);
					}
				}
				
			},
			
			&#x2F;**
			 * Destroys the popup and any resources it is holding onto.
			 * @method destroy
			 *&#x2F;
			destroy: function() {
				this.id = null;
		        this.lonlat = null;
		        this.size = null;
		        this.contentHTML = null;
		        
		        this.backgroundColor = null;
		        this.opacity = null;
		        this.border = null;
		        
		        if (this.closeOnMove &amp;&amp; this.map) {
		            this.map.events.unregister(&quot;movestart&quot;, this, this.hide);
		        }
		
		        if (this.events)
		        	this.events.destroy();
		        
		        this.events = null;
		        
		        if (this.closeDiv) {
		            OpenLayers.Event.stopObservingElement(this.closeDiv); 
		            this.groupDiv.removeChild(this.closeDiv);
		        }
		        this.closeDiv = null;
		        
		        if (this.div &amp;&amp; this.groupDiv)
		        	this.div.removeChild(this.groupDiv);
		        
		        this.groupDiv = null;
		
		        if (this.map != null) {
		            this.map.removePopup(this);
		        }
		        
		        this.map = null;
		        this.div = null;
		        
		        this.autoSize = null;
		        this.minSize = null;
		        this.maxSize = null;
		        this.padding = null;
		        this.panMapIfOutOfView = null;
			}
			
		});
		
		return tomtom.Popup;
	
	}
);
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
