<!DOCTYPE html>
<html>
<head>
<title>ForwardObserver</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0" />
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="stylesheet" type="text/css" css="css/map.css" />
<link rel="stylesheet" type="text/css" href="css/tomtom.map.min.css" />
<script type="text/javascript" src="js/leaflet.js"></script>
<script type="text/javascript" src="js/tomtom.map.js"></script>

<script type="text/javascript">


function geoError(){
	document.write("Shit. Geolocation fucked up.");
}

function updateLocation(){
	// move the you are here marker to new location
	marker.setLatLng([position.coords.latitude, position.coords.longitude]);
}

function initialize(){
	// we find out about where we are first
        if (navigator.geolocation){
                navigator.geolocation.getCurrentPosition(function(position){
			lat = position.coords.latitude;
			lon = position.coords.longitude;
			heading = position.coords.heading;
			speed = position.coords.speed;
			timestamp = position.coords.timestamp
			tomtom.setImagePath("/images/map");
			map = new tomtom.Map({ 
				domNode: "map", 
				apiKey: "q3dh8pqnwmbdrvwctrgvm6nu",
				center: [lat, lon],
				zoom: 15,
				zoomControl: true,
				enableHighAccuracy: true,
				watch: true,
				maximumAge: 6000,
			});
			
			map.setDisplayTraffic(true);

			var options = {
				iconUrl: "http://www.airmanopus.net/BoilerMake/images/marker.png", 
				iconSize: [41, 50],
				iconAnchor: [11, 39]
			};
			var marker = new tomtom.Marker([lat,lon], options);
			map.addLayer(marker);

		});

	}
}




function weather(latitude,longitude)
{
	weatherURL = "http://api.worldweatheronline.com/free/v1/weather.ashx?q=" + latitude + "%2C" + longitude + "&format=json&num_of_days=1&includelocation=yes&show_comments=no&key=kc2u593rw3h5bp2pga7fs7ut";
	weather = XMLHttpRequest();
	weather.open('GET',weatherURL,false);
	weather.send();

	console.log(weather.responseText);
	document.getElementById("weather").textContent = weather.responseText;
	}
}



</script>
<style>
head,body,#map {
	width: 100%;
	height: 90%;
	padding: 1px;
	margin: 1px;
}
</style>
<body onLoad="initialize()">
<div id="map"></div>
<div id="weather"></div>
</body>
</html>
