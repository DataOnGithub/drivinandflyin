<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>TomTom JavaScript SDK - Map</title>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" src="../../js/OpenLayers-2.12.min.js"></script>
        <script type="text/javascript" src="../../js/jquery/tomtom.services.js"></script>
        <script type="text/javascript" src="../apikey.js"></script>
        <script type="text/javascript">
        	$(function() {
	      		
	   			var container = $("#geocode");
	   			var geocoder = new tomtom.services.GeocodingService();
	       		
	   			// forward geocode
	   			container.find("button").bind("click", function() {
	       			container.find(".result").html("Loading...");
	       			
	       			var address = container.find("input").val();        			
	       			
	       			// this is the one line that executes the geocode query
	       			geocoder.geocode(address, function(response) {
	       				container.find(".result").html(JSON.stringify(response, null, 4));
	       			});
	       		});
	   			
	   			// reverse geocode
	   			var reverseContainer = $("#reverseGeocode");
	   			
	   			reverseContainer.find("button").bind("click", function() {
	       			reverseContainer.find(".result").html("Loading...");
	       			
	   				var latitude = reverseContainer.find("input[name='latitude']").val();
	   				var longitude = reverseContainer.find("input[name='longitude']").val();
	   				
	   				geocoder.reverseGeocode(longitude, latitude, function(response) {
	   					reverseContainer.find(".result").html(JSON.stringify(response, null, 4));
	   				});
	   			});
	   			
	   			// traffic model
	   			var trafficContainer = $("#traffic");
	   			
	   			trafficContainer.find("button").bind("click", function() {
	   				trafficContainer.find(".result").html("Loading...");
	   				
	   				var window = {
	   					left: trafficContainer.find("input[name='minLongitude']").val(),
	   					bottom: trafficContainer.find("input[name='maxLatitude']").val(),
	   					right: trafficContainer.find("input[name='maxLongitude']").val(),
	   					top: trafficContainer.find("input[name='minLatitude']").val()
	   				};
	   				
	   				var zoom = trafficContainer.find("input[name='zoom']").val();
	   				
	   				var trafficService = new tomtom.services.TrafficService();
	   				
	   				trafficService.getTrafficModel(window, zoom, function(response) { 
	   					trafficContainer.find(".result").html(JSON.stringify(response, null, 4));
	   				});
	   			});
	   			
	   			// routing
	   			var routingContainer = $("#routing");
	       		
	   			routingContainer.find("button").bind("click", function() {
	   				routingContainer.find(".result").html("Loading...");
	   				
	   				var points = [];
	   				
	   				// loop through each potential point
	   				for (var pointIndex = 0; pointIndex < 5; pointIndex++) {
	   					var lat = routingContainer.find("input[name='lat" + pointIndex + "']").val();
	   					var lon = routingContainer.find("input[name='lon" + pointIndex + "']").val();
	   					
	   					// if the lat / lon were specified, add the point
	   					if (lat && lon) {
	   						points.push({lat: lat, lon: lon});
	   					}
	   				}
	   				
	   				var routingService = new tomtom.services.RoutingService();
	   				
	   				routingService.getRoute(points, { avoidTraffic: true, includeTraffic: true }, function(response) {
	   					routingContainer.find(".result").html(JSON.stringify(response, null, 4));
	   				});
	   			});
	   			
	   			var viewportContainer = $("#viewport");
	   			
	   			viewportContainer.find("button").bind("click", function() {
	   				viewportContainer.find(".result").html("Loading...");
	   				
	   				var viewportService = new tomtom.services.ViewportService();
	   				
	   				var window = {
	   					left: viewportContainer.find("input[name='minLongitude']").val(),
	   					bottom: viewportContainer.find("input[name='maxLatitude']").val(),
	   					right: viewportContainer.find("input[name='maxLongitude']").val(),
	   					top: viewportContainer.find("input[name='minLatitude']").val()
	   				};
	   				
	   				var zoom = viewportContainer.find("input[name='zoom']").val();
	   				
	   				viewportService.getViewportModel(window, zoom, window, zoom, function(response) {
	   					viewportContainer.find(".result").html(JSON.stringify(response, null, 4));
	   				});
	   			});
        	});
        </script>
        <style type="text/css">
        	html, body {
        		width: 100%;
        		height: 100%;
        	}
        	
			.service {
				margin: 10px;
				border: 1px solid #ccc;
				padding: 20px;
				width: 600px;
				float: left;
			}
			
			.service h2 {
				margin-top: 0;
			}
        	
        	.service pre {
        		height: 300px;
        		overflow: auto;
        	}
        </style>
	</head>
	<body>
		<h1>Service Tests</h1>
		
		<div class="service" id="geocode">
			<h2>Geocode</h2>
			<label>Address:</label><input type="text" />
			<button>Submit</button>
			
			<pre class="result prettyprint">
			
			</pre>
		</div>
		
		<div class="service" id="reverseGeocode">
			<h2>Reverse Geocode</h2>
			<label>Latitude:</label><input type="text" name="latitude" />
			<label>Longitude:</label><input type="text" name="longitude" />
			<button>Submit</button>
			
			<pre class="result prettyprint">
			
			</pre>
		</div>
		
		<div class="service" id="traffic">
			<h2>Traffic</h2>
			<div>
				<label>Latitude:</label><input type="text" name="minLatitude" value="46.41513882831074" />
				<label>Longitude:</label><input type="text" name="minLongitude" value ="-93.89575624695162" />
			</div>
			<div>
				<label>Latitude:</label><input type="text" name="maxLatitude" value="34.94899078738923" />
				<label>Longitude:</label><input type="text" name="maxLongitude" value="-53.57593202820306" />
			</div>
			<label>Zoom:</label><input type="text" name="zoom" value="6" />
			<button>Submit</button>
			
			<pre class="result prettyprint">
			
			</pre>
		</div>
		
		<div class="service" id="routing">
			<h2>Routing</h2>
			<div>
				<h3>Start</h3>
				<label>Latitude:</label><input type="text" name="lat0" value="43.20846" />
				<label>Longitude:</label><input type="text" name="lon0" value ="-71.53686" />
			</div>
			<div>
				<h3>Point 1</h3>
				<label>Latitude:</label><input type="text" name="lat1" value="" />
				<label>Longitude:</label><input type="text" name="lon1" value ="" />
			</div>
			<div>
				<h3>Point 2</h3>
				<label>Latitude:</label><input type="text" name="lat2" value="" />
				<label>Longitude:</label><input type="text" name="lon2" value ="" />
			</div>
			<div>
				<h3>Point 3</h3>
				<label>Latitude:</label><input type="text" name="lat3" value="" />
				<label>Longitude:</label><input type="text" name="lon3" value ="" />
			</div>
			<div>
				<h3>End</h3>
				<label>Latitude:</label><input type="text" name="lat4" value="42.35779" />
				<label>Longitude:</label><input type="text" name="lon4" value ="-71.05976" />
			</div>
			<button>Submit</button>
			
			<pre class="result prettyprint">
			
			</pre>
		</div>
		
		<div class="service" id="viewport">
			<h2>Viewport</h2>
			<div>
				<label>Latitude:</label><input type="text" name="minLatitude" value="46.41513882831074" />
				<label>Longitude:</label><input type="text" name="minLongitude" value ="-93.89575624695162" />
			</div>
			<div>
				<label>Latitude:</label><input type="text" name="maxLatitude" value="34.94899078738923" />
				<label>Longitude:</label><input type="text" name="maxLongitude" value="-53.57593202820306" />
			</div>
			<label>Zoom:</label><input type="text" name="zoom" value="6" />
			<button>Submit</button>
			
			<pre class="result prettyprint">
			
			</pre>
		</div>
	</body>
</html>